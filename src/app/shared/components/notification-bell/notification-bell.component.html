<button 
  class="icon-btn notification-btn" 
  [matMenuTriggerFor]="notificationMenu"
  [matBadge]="unreadCount"
  [matBadgeHidden]="unreadCount === 0"
  matBadgeColor="warn"
  matBadgeSize="small">
  <mat-icon>notifications</mat-icon>
</button>

<mat-menu #notificationMenu="matMenu" class="notification-menu" xPosition="before">
  <div class="notification-header" (click)="$event.stopPropagation()">
    <h3>Notifications</h3>
    @if (unreadCount > 0) {
      <button class="mark-all-btn" (click)="markAllAsRead()">
        Mark all as read
      </button>
    }
  </div>

  <div class="notification-list">
    @if (notifications.length === 0) {
      <div class="empty-state">
        <mat-icon>notifications_none</mat-icon>
        <p>No notifications</p>
      </div>
    } @else {
      @for (notification of notifications; track notification.id) {
        <button 
          mat-menu-item 
          class="notification-item"
          [class.unread]="!notification.read"
          (click)="markAsRead(notification.id)">
          <div class="notification-icon" [style.background]="notification.color">
            <mat-icon>{{ getNotificationIcon(notification) }}</mat-icon>
          </div>
          <div class="notification-content">
            <h4>{{ notification.title }}</h4>
            <p>{{ notification.message }}</p>
            <span class="notification-time">{{ getTimeAgo(notification.timestamp) }}</span>
          </div>
          @if (!notification.read) {
            <div class="unread-dot"></div>
          }
        </button>
      }
    }
  </div>

  <div class="notification-footer">
    <button mat-button routerLink="/notifications" class="view-all-btn">
      View All Notifications
    </button>
  </div>
</mat-menu>
